<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 2.1 Basic Music Engine - å˜ä½“ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1, h2 {
            color: #00ffff;
            border-bottom: 2px solid #00ffff;
            padding-bottom: 10px;
        }
        
        .test-section {
            background: #2a2a2a;
            border: 1px solid #555;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
        }
        
        button:hover {
            background: #0088ff;
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .test-result {
            background: #333;
            border-left: 4px solid #00ff00;
            padding: 15px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .test-result.error {
            border-left-color: #ff0000;
            color: #ff9999;
        }
        
        .test-result.warning {
            border-left-color: #ffaa00;
            color: #ffcc99;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #555;
        }
        
        .stat-title {
            color: #00ffff;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 18px;
            color: #00ff00;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 0 10px #00ffff;
        }
        
        .phase-indicator {
            background: linear-gradient(45deg, #0066cc, #00ffff);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .success { color: #00ff00; }
        .error { color: #ff4444; }
        .warning { color: #ffaa00; }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <h1>ğŸ¼ Phase 2.1: Basic Music Engine</h1>
            <div class="phase-indicator">Phase 2.1: åŸºæœ¬éŸ³æ¥½å†ç”Ÿã‚¨ãƒ³ã‚¸ãƒ³æ¤œè¨¼</div>
        </div>
        
        <!-- 1. åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸš€ 1. åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button onclick="testEngineInitialization()">ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testInstrumentCreation()">æ¥½å™¨ä½œæˆãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testTransportSetup()">Transportè¨­å®šãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div id="init-result" class="test-result"></div>
        </div>
        
        <!-- 2. BGMå†ç”Ÿãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸµ 2. BGMå†ç”Ÿãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button onclick="testSimpleBGMPlay()">ã‚·ãƒ³ãƒ—ãƒ«BGMå†ç”Ÿ</button>
                <button onclick="testBGMPause()">BGMä¸€æ™‚åœæ­¢</button>
                <button onclick="testBGMResume()">BGMå†é–‹</button>
                <button onclick="testBGMStop()">BGMåœæ­¢</button>
            </div>
            <div id="bgm-result" class="test-result"></div>
        </div>
        
        <!-- 3. æ¥½å™¨åˆ¥ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸ¹ 3. æ¥½å™¨åˆ¥ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button onclick="testLeadSynth()">Lead Synth ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testBassSynth()">Bass Synth ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testPadSynth()">Pad Synth ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testAllInstruments()">å…¨æ¥½å™¨åŒæ™‚ãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div id="instrument-result" class="test-result"></div>
        </div>
        
        <!-- 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>âš¡ 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button onclick="testLatency()">ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testMemoryUsage()">ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testCPUUsage()">CPUä½¿ç”¨ç‡ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testLongRunning()">é•·æ™‚é–“å‹•ä½œãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div id="performance-result" class="test-result"></div>
        </div>
        
        <!-- 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸ›¡ï¸ 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</h2>
            <div class="test-controls">
                <button onclick="testInvalidOperations()">ç„¡åŠ¹æ“ä½œãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testResourceExhaustion()">ãƒªã‚½ãƒ¼ã‚¹æ¯æ¸‡ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="testRecovery()">å¾©æ—§ãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div id="error-result" class="test-result"></div>
        </div>
        
        <!-- 6. çµ±è¨ˆãƒ»ç›£è¦– -->
        <div class="test-section">
            <h2>ğŸ“Š 6. ã‚¨ãƒ³ã‚¸ãƒ³çŠ¶æ…‹ãƒ»çµ±è¨ˆ</h2>
            <div class="test-controls">
                <button onclick="updateEngineStatus()">çŠ¶æ…‹æ›´æ–°</button>
                <button onclick="clearAllTests()">å…¨ãƒ†ã‚¹ãƒˆã‚¯ãƒªã‚¢</button>
                <button onclick="runFullTestSuite()">å®Œå…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-title">åˆæœŸåŒ–çŠ¶æ…‹</div>
                    <div class="stat-value" id="stat-initialized">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">å†ç”ŸçŠ¶æ…‹</div>
                    <div class="stat-value" id="stat-playing">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãƒ¼ (ms)</div>
                    <div class="stat-value" id="stat-latency">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ãƒ†ãƒ³ãƒ (BPM)</div>
                    <div class="stat-value" id="stat-tempo">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">æ¥½å™¨æ•°</div>
                    <div class="stat-value" id="stat-instruments">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ã‚¨ãƒ©ãƒ¼æ•°</div>
                    <div class="stat-value" id="stat-errors">-</div>
                </div>
            </div>
            
            <div id="status-result" class="test-result"></div>
        </div>
    </div>

    <!-- Tone.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tone@latest/build/Tone.js"></script>
    
    <script type="module">
        import { BasicMusicEngine } from './public/js/systems/basic-music-engine.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let musicEngine = null;
        let testResults = [];
        let testCounter = 0;
        
        // ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–
        async function initializeEngine() {
            try {
                if (!musicEngine) {
                    musicEngine = new BasicMusicEngine();
                    const result = await musicEngine.initializeMusicEngine();
                    return result;
                }
                return { success: true, message: 'already_initialized' };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }
        
        // 1. åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ
        window.testEngineInitialization = async function() {
            const startTime = performance.now();
            try {
                displayResult('init-result', 'ğŸš€ ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                const result = await initializeEngine();
                const latency = performance.now() - startTime;
                
                if (result.success) {
                    displayResult('init-result', 
                        `âœ… ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–æˆåŠŸ (${latency.toFixed(2)}ms)\n` +
                        `è©³ç´°: ${JSON.stringify(result, null, 2)}`, 'success');
                } else {
                    displayResult('init-result', 
                        `âŒ ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ–å¤±æ•—: ${result.error}`, 'error');
                }
                
                updateEngineStatus();
            } catch (error) {
                displayResult('init-result', `âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testInstrumentCreation = async function() {
            try {
                displayResult('init-result', 'ğŸ¹ æ¥½å™¨ä½œæˆãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                const status = musicEngine.getEngineStatus();
                
                const instrumentCount = Object.values(status.instruments).filter(Boolean).length;
                
                if (instrumentCount === 3) {
                    displayResult('init-result', 
                        `âœ… æ¥½å™¨ä½œæˆæˆåŠŸ (${instrumentCount}/3)\n` +
                        `æ¥½å™¨: ${JSON.stringify(status.instruments, null, 2)}`, 'success');
                } else {
                    displayResult('init-result', 
                        `âš ï¸ æ¥½å™¨ä½œæˆä¸å®Œå…¨ (${instrumentCount}/3)`, 'warning');
                }
            } catch (error) {
                displayResult('init-result', `âŒ æ¥½å™¨ä½œæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testTransportSetup = async function() {
            try {
                displayResult('init-result', 'â¯ï¸ Transportè¨­å®šãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                const status = musicEngine.getEngineStatus();
                
                if (status.transport && status.transport !== 'not_available') {
                    displayResult('init-result', 
                        `âœ… Transportè¨­å®šæˆåŠŸ\n` +
                        `çŠ¶æ…‹: ${status.transport}\n` +
                        `ãƒ†ãƒ³ãƒ: ${status.tempo} BPM`, 'success');
                } else {
                    displayResult('init-result', 
                        `âŒ Transportè¨­å®šå¤±æ•—: ${status.transport}`, 'error');
                }
            } catch (error) {
                displayResult('init-result', `âŒ Transportè¨­å®šã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // 2. BGMå†ç”Ÿãƒ†ã‚¹ãƒˆ
        window.testSimpleBGMPlay = async function() {
            try {
                displayResult('bgm-result', 'ğŸµ ã‚·ãƒ³ãƒ—ãƒ«BGMå†ç”Ÿãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                const result = await musicEngine.playSimpleBGM();
                
                if (result.success) {
                    displayResult('bgm-result', 
                        `âœ… BGMå†ç”Ÿé–‹å§‹æˆåŠŸ\n` +
                        `ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${result.message}`, 'success');
                } else {
                    displayResult('bgm-result', 
                        `âŒ BGMå†ç”Ÿå¤±æ•—: ${result.error}`, 'error');
                }
                
                updateEngineStatus();
            } catch (error) {
                displayResult('bgm-result', `âŒ BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testBGMPause = async function() {
            try {
                displayResult('bgm-result', 'â¸ï¸ BGMä¸€æ™‚åœæ­¢ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                const result = musicEngine ? musicEngine.pauseBGM() : { success: false, error: 'engine_not_initialized' };
                
                if (result.success) {
                    displayResult('bgm-result', `âœ… BGMä¸€æ™‚åœæ­¢æˆåŠŸ`, 'success');
                } else {
                    displayResult('bgm-result', `âŒ BGMä¸€æ™‚åœæ­¢å¤±æ•—: ${result.error}`, 'error');
                }
                
                updateEngineStatus();
            } catch (error) {
                displayResult('bgm-result', `âŒ BGMä¸€æ™‚åœæ­¢ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testBGMResume = async function() {
            try {
                displayResult('bgm-result', 'â–¶ï¸ BGMå†é–‹ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                const result = musicEngine ? musicEngine.resumeBGM() : { success: false, error: 'engine_not_initialized' };
                
                if (result.success) {
                    displayResult('bgm-result', `âœ… BGMå†é–‹æˆåŠŸ`, 'success');
                } else {
                    displayResult('bgm-result', `âŒ BGMå†é–‹å¤±æ•—: ${result.error}`, 'error');
                }
                
                updateEngineStatus();
            } catch (error) {
                displayResult('bgm-result', `âŒ BGMå†é–‹ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testBGMStop = async function() {
            try {
                displayResult('bgm-result', 'â¹ï¸ BGMåœæ­¢ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                const result = musicEngine ? musicEngine.stopBGM() : { success: false, error: 'engine_not_initialized' };
                
                if (result.success) {
                    displayResult('bgm-result', `âœ… BGMåœæ­¢æˆåŠŸ`, 'success');
                } else {
                    displayResult('bgm-result', `âŒ BGMåœæ­¢å¤±æ•—: ${result.error}`, 'error');
                }
                
                updateEngineStatus();
            } catch (error) {
                displayResult('bgm-result', `âŒ BGMåœæ­¢ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // 3. æ¥½å™¨åˆ¥ãƒ†ã‚¹ãƒˆ
        window.testLeadSynth = async function() {
            try {
                displayResult('instrument-result', 'ğŸ¹ Lead Synth ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                
                if (musicEngine.instruments.leadSynth) {
                    musicEngine.instruments.leadSynth.triggerAttackRelease('C4', '4n');
                    displayResult('instrument-result', `âœ… Lead Synth ãƒ†ã‚¹ãƒˆæˆåŠŸ (C4éŸ³å†ç”Ÿ)`, 'success');
                } else {
                    displayResult('instrument-result', `âŒ Lead Synth ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“`, 'error');
                }
            } catch (error) {
                displayResult('instrument-result', `âŒ Lead Synth ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testBassSynth = async function() {
            try {
                displayResult('instrument-result', 'ğŸ¸ Bass Synth ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                
                if (musicEngine.instruments.bassSynth) {
                    musicEngine.instruments.bassSynth.triggerAttackRelease('C2', '2n');
                    displayResult('instrument-result', `âœ… Bass Synth ãƒ†ã‚¹ãƒˆæˆåŠŸ (C2éŸ³å†ç”Ÿ)`, 'success');
                } else {
                    displayResult('instrument-result', `âŒ Bass Synth ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“`, 'error');
                }
            } catch (error) {
                displayResult('instrument-result', `âŒ Bass Synth ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testPadSynth = async function() {
            try {
                displayResult('instrument-result', 'ğŸ¹ Pad Synth ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                
                if (musicEngine.instruments.padSynth) {
                    musicEngine.instruments.padSynth.triggerAttackRelease(['C4', 'E4', 'G4'], '1n');
                    displayResult('instrument-result', `âœ… Pad Synth ãƒ†ã‚¹ãƒˆæˆåŠŸ (Cãƒ¡ã‚¸ãƒ£ãƒ¼å’ŒéŸ³å†ç”Ÿ)`, 'success');
                } else {
                    displayResult('instrument-result', `âŒ Pad Synth ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“`, 'error');
                }
            } catch (error) {
                displayResult('instrument-result', `âŒ Pad Synth ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testAllInstruments = async function() {
            try {
                displayResult('instrument-result', 'ğŸ¼ å…¨æ¥½å™¨åŒæ™‚ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                
                await initializeEngine();
                
                let successCount = 0;
                const totalInstruments = 3;
                
                // Lead
                if (musicEngine.instruments.leadSynth) {
                    musicEngine.instruments.leadSynth.triggerAttackRelease('E4', '4n');
                    successCount++;
                }
                
                // Bass (å°‘ã—é…å»¶)
                setTimeout(() => {
                    if (musicEngine.instruments.bassSynth) {
                        musicEngine.instruments.bassSynth.triggerAttackRelease('C2', '2n');
                        successCount++;
                    }
                }, 100);
                
                // Pad (ã•ã‚‰ã«é…å»¶)
                setTimeout(() => {
                    if (musicEngine.instruments.padSynth) {
                        musicEngine.instruments.padSynth.triggerAttackRelease(['C4', 'E4', 'G4'], '1n');
                        successCount++;
                    }
                    
                    displayResult('instrument-result', 
                        `âœ… å…¨æ¥½å™¨åŒæ™‚ãƒ†ã‚¹ãƒˆå®Œäº† (${successCount}/${totalInstruments}æ¥½å™¨æˆåŠŸ)`, 
                        successCount === totalInstruments ? 'success' : 'warning');
                }, 200);
                
            } catch (error) {
                displayResult('instrument-result', `âŒ å…¨æ¥½å™¨åŒæ™‚ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // 6. çŠ¶æ…‹æ›´æ–°
        window.updateEngineStatus = function() {
            try {
                if (!musicEngine) {
                    displayResult('status-result', 'âš ï¸ ã‚¨ãƒ³ã‚¸ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning');
                    return;
                }
                
                const status = musicEngine.getEngineStatus();
                
                // çµ±è¨ˆæ›´æ–°
                document.getElementById('stat-initialized').textContent = status.initialized ? 'âœ… æ¸ˆã¿' : 'âŒ æœªå®Œäº†';
                document.getElementById('stat-playing').textContent = status.playing ? 'ğŸµ å†ç”Ÿä¸­' : 'â¹ï¸ åœæ­¢ä¸­';
                document.getElementById('stat-latency').textContent = status.performance?.latency?.toFixed(2) || '-';
                document.getElementById('stat-tempo').textContent = status.tempo;
                
                const instrumentCount = Object.values(status.instruments).filter(Boolean).length;
                document.getElementById('stat-instruments').textContent = `${instrumentCount}/3`;
                
                document.getElementById('stat-errors').textContent = musicEngine.errorHistory?.length || 0;
                
                // è©³ç´°çŠ¶æ…‹è¡¨ç¤º
                displayResult('status-result', 
                    `ğŸ“Š ã‚¨ãƒ³ã‚¸ãƒ³çŠ¶æ…‹æ›´æ–° (${new Date().toLocaleTimeString()})\n` +
                    JSON.stringify(status, null, 2), 'info');
                    
            } catch (error) {
                displayResult('status-result', `âŒ çŠ¶æ…‹æ›´æ–°ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // å®Œå…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ
        window.runFullTestSuite = async function() {
            try {
                displayResult('status-result', 'ğŸ”¬ å®Œå…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œé–‹å§‹...', 'info');
                
                const tests = [
                    testEngineInitialization,
                    testInstrumentCreation,
                    testTransportSetup,
                    testLeadSynth,
                    testBassSynth,
                    testPadSynth,
                    testSimpleBGMPlay
                ];
                
                let passedTests = 0;
                
                for (let i = 0; i < tests.length; i++) {
                    try {
                        await tests[i]();
                        passedTests++;
                        await new Promise(resolve => setTimeout(resolve, 500)); // ãƒ†ã‚¹ãƒˆé–“éš”
                    } catch (error) {
                        console.error(`Test ${i} failed:`, error);
                    }
                }
                
                displayResult('status-result', 
                    `ğŸ¯ å®Œå…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Œäº†\n` +
                    `çµæœ: ${passedTests}/${tests.length} ãƒ†ã‚¹ãƒˆæˆåŠŸ\n` +
                    `æˆåŠŸç‡: ${((passedTests / tests.length) * 100).toFixed(1)}%`, 
                    passedTests === tests.length ? 'success' : 'warning');
                    
            } catch (error) {
                displayResult('status-result', `âŒ ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // å…¨ãƒ†ã‚¹ãƒˆã‚¯ãƒªã‚¢
        window.clearAllTests = function() {
            const resultElements = document.querySelectorAll('.test-result');
            resultElements.forEach(element => {
                element.textContent = '';
                element.className = 'test-result';
            });
            
            // çµ±è¨ˆãƒªã‚»ãƒƒãƒˆ
            document.getElementById('stat-initialized').textContent = '-';
            document.getElementById('stat-playing').textContent = '-';
            document.getElementById('stat-latency').textContent = '-';
            document.getElementById('stat-tempo').textContent = '-';
            document.getElementById('stat-instruments').textContent = '-';
            document.getElementById('stat-errors').textContent = '-';
        };
        
        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function displayResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = message;
                element.className = `test-result ${type}`;
            }
        }
        
        // åˆæœŸåŒ–æ™‚ã«è‡ªå‹•ã§çŠ¶æ…‹æ›´æ–°
        setTimeout(() => {
            console.log('ğŸ¼ Phase 2.1 Basic Music Engine Test Page Ready');
        }, 100);
        
    </script>
</body>
</html>