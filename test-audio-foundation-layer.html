<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioFoundationLayer ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #00ff00;
            padding-bottom: 20px;
        }
        .test-section {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            margin: 20px 0;
            padding: 20px;
            border-radius: 5px;
        }
        .button {
            background: #003300;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 3px;
            font-family: inherit;
        }
        .button:hover {
            background: #004400;
        }
        .button:disabled {
            background: #222;
            color: #666;
            cursor: not-allowed;
        }
        .status-display {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            padding: 15px;
            margin: 10px 0;
            border-radius: 3px;
            font-size: 14px;
            white-space: pre-line;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { color: #00ff00; }
        .warning { color: #ffaa00; }
        .error { color: #ff0000; }
        .info { color: #00aaff; }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: rgba(0, 100, 0, 0.1);
            border: 1px solid #006600;
            padding: 15px;
            border-radius: 5px;
        }
        
        .metric-title {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .metric-value {
            color: #ffffff;
            font-size: 1.2em;
        }
        
        .phase-indicator {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            margin: 5px;
            font-weight: bold;
        }
        
        .phase-pending { background: #333; color: #999; }
        .phase-current { background: #ff6600; color: #fff; }
        .phase-completed { background: #00aa00; color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ AudioFoundationLayer ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>æ–°éŸ³éŸ¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ Phase 1 - åŸºç›¤ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ†ã‚¹ãƒˆ</p>
            
            <!-- ãƒ•ã‚§ãƒ¼ã‚ºé€²è¡Œã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
            <div class="phase-progress">
                <span class="phase-indicator phase-current">Phase 1.1: åŸºæœ¬æ§‹é€ </span>
                <span class="phase-indicator phase-pending">Phase 1.2: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†</span>
                <span class="phase-indicator phase-pending">Phase 1.3: ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†</span>
                <span class="phase-indicator phase-pending">Phase 1.4: ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ </span>
                <span class="phase-indicator phase-pending">Phase 1.5: ãƒ†ã‚¹ãƒˆæ¤œè¨¼</span>
            </div>
        </div>

        <!-- Phase 1.1 ãƒ†ã‚¹ãƒˆ: åŸºæœ¬æ§‹é€  -->
        <div class="test-section">
            <h2>ğŸ—ï¸ Phase 1.1: åŸºæœ¬æ§‹é€ ãƒ†ã‚¹ãƒˆ</h2>
            <p>å‹å®šç¾©ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ»ã‚¯ãƒ©ã‚¹éª¨æ ¼ã®æ¤œè¨¼</p>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-title">ã‚¯ãƒ©ã‚¹èª­ã¿è¾¼ã¿çŠ¶æ…‹</div>
                    <div class="metric-value" id="class-load-status">æœªç¢ºèª</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æ¤œè¨¼</div>
                    <div class="metric-value" id="interface-status">æœªç¢ºèª</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">å‹æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ </div>
                    <div class="metric-value" id="type-validation-status">æœªç¢ºèª</div>
                </div>
                <div class="metric-card">
                    <div class="metric-title">ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ </div>
                    <div class="metric-value" id="error-system-status">æœªç¢ºèª</div>
                </div>
            </div>
            
            <button class="button" onclick="testPhase11()">ğŸ§ª Phase 1.1 ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button class="button" onclick="testClassStructure()">ğŸ—ï¸ ã‚¯ãƒ©ã‚¹æ§‹é€ ãƒ†ã‚¹ãƒˆ</button>
            <button class="button" onclick="testTypeSystem()">ğŸ” å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</button>
            <button class="button" onclick="testErrorSystem()">ğŸš¨ ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</button>
        </div>

        <!-- ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸ”§ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ»åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ</h2>
            <p>AudioFoundationLayerã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆãƒ»åˆæœŸçŠ¶æ…‹æ¤œè¨¼</p>
            
            <button class="button" onclick="testConstructor()">ğŸ—ï¸ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ã‚¹ãƒˆ</button>
            <button class="button" onclick="testInitialState()">ğŸ” åˆæœŸçŠ¶æ…‹ç¢ºèª</button>
            <button class="button" onclick="testDebugInfo()">ğŸ“Š ãƒ‡ãƒãƒƒã‚°æƒ…å ±å–å¾—</button>
        </div>

        <!-- äºˆå®šå®Ÿè£…ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h2>ğŸ“‹ äºˆå®šå®Ÿè£…ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ</h2>
            <p>Phase 1.2-1.4ã§å®Ÿè£…äºˆå®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚¹ã‚¿ãƒ–ç¢ºèª</p>
            
            <button class="button" onclick="testPendingMethods()">ğŸ”® äºˆå®šãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ</button>
            <button class="button" onclick="showImplementationPlan()">ğŸ“… å®Ÿè£…è¨ˆç”»è¡¨ç¤º</button>
        </div>

        <!-- ãƒ­ã‚°ãƒ»è¨ºæ–­è¡¨ç¤º -->
        <div class="test-section">
            <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœãƒ»è¨ºæ–­æƒ…å ±</h2>
            <div id="test-results" class="status-display">
                ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
            </div>
            <button class="button" onclick="clearLog()">ğŸ§¹ ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            <button class="button" onclick="exportTestResults()">ğŸ’¾ çµæœã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>
    </div>

    <!-- Tone.jsèª­ã¿è¾¼ã¿ -->
    <script src="https://unpkg.com/tone@latest/build/Tone.js"></script>
    
    <!-- AudioFoundationLayerèª­ã¿è¾¼ã¿ -->
    <script type="module">
        import { AudioFoundationLayer } from './public/js/systems/audio-foundation-layer.js';
        import { 
            AudioError, 
            AudioContextError, 
            ResourceError, 
            SynthError,
            AudioTypeValidator,
            AudioPerformanceTracker,
            AudioDebugLogger,
            AudioFoundationConfig
        } from './public/js/systems/audio-types.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let foundationLayer = null;
        let testResults = [];
        let testSession = {
            startTime: Date.now(),
            phase: '1.1',
            results: []
        };
        
        // ==================== Phase 1.1 ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ ====================
        
        async function testPhase11() {
            logToDisplay('ğŸ§ª Phase 1.1 åŒ…æ‹¬ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            const tests = [
                testClassStructure,
                testTypeSystem,
                testErrorSystem,
                testConstructor,
                testInitialState
            ];
            
            let passed = 0;
            let total = tests.length;
            
            for (const test of tests) {
                try {
                    const result = await test();
                    if (result) passed++;
                } catch (error) {
                    logToDisplay(`âŒ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                }
            }
            
            const successRate = Math.round((passed / total) * 100);
            const status = successRate >= 80 ? 'success' : successRate >= 60 ? 'warning' : 'error';
            
            logToDisplay(`âœ… Phase 1.1 ãƒ†ã‚¹ãƒˆå®Œäº†: ${passed}/${total} æˆåŠŸ (${successRate}%)`, status);
            
            updatePhaseStatus('1.1', successRate >= 80 ? 'completed' : 'current');
        }
        
        // ==================== å€‹åˆ¥ãƒ†ã‚¹ãƒˆé–¢æ•° ====================
        
        async function testClassStructure() {
            logToDisplay('ğŸ—ï¸ ã‚¯ãƒ©ã‚¹æ§‹é€ ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            try {
                // AudioFoundationLayerã‚¯ãƒ©ã‚¹å­˜åœ¨ç¢ºèª
                if (typeof AudioFoundationLayer !== 'function') {
                    throw new Error('AudioFoundationLayer class not found');
                }
                
                // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆãƒ†ã‚¹ãƒˆ
                const layer = new AudioFoundationLayer();
                if (!(layer instanceof AudioFoundationLayer)) {
                    throw new Error('Instance creation failed');
                }
                
                // å¿…é ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¢ºèª
                const requiredProps = ['isInitialized', 'context', 'synthPool', 'performanceTracker'];
                for (const prop of requiredProps) {
                    if (!(prop in layer)) {
                        throw new Error(`Required property missing: ${prop}`);
                    }
                }
                
                // å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰ç¢ºèª
                const requiredMethods = ['initializeContext', 'createSynth', 'getResourceStats'];
                for (const method of requiredMethods) {
                    if (typeof layer[method] !== 'function') {
                        throw new Error(`Required method missing: ${method}`);
                    }
                }
                
                updateMetric('class-load-status', 'âœ… æ­£å¸¸');
                logToDisplay('âœ… ã‚¯ãƒ©ã‚¹æ§‹é€ ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'success');
                return true;
                
            } catch (error) {
                updateMetric('class-load-status', 'âŒ å¤±æ•—');
                logToDisplay(`âŒ ã‚¯ãƒ©ã‚¹æ§‹é€ ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testTypeSystem() {
            logToDisplay('ğŸ” å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            try {
                // AudioTypeValidator ãƒ†ã‚¹ãƒˆ
                const validTypes = ['basic', 'plasma', 'nuke'];
                const invalidTypes = ['invalid', null, 123];
                
                for (const type of validTypes) {
                    if (!AudioTypeValidator.isValidSynthType(type)) {
                        throw new Error(`Valid type rejected: ${type}`);
                    }
                }
                
                for (const type of invalidTypes) {
                    if (AudioTypeValidator.isValidSynthType(type)) {
                        throw new Error(`Invalid type accepted: ${type}`);
                    }
                }
                
                // SynthConfig ãƒ†ã‚¹ãƒˆ
                const validConfigs = [
                    { volume: 0.5 },
                    { volume: 1.0, maxVoices: 2 },
                    {}
                ];
                
                const invalidConfigs = [
                    { volume: -1 },
                    { volume: 2 },
                    { maxVoices: 0 },
                    null
                ];
                
                for (const config of validConfigs) {
                    if (!AudioTypeValidator.isValidSynthConfig(config)) {
                        throw new Error(`Valid config rejected: ${JSON.stringify(config)}`);
                    }
                }
                
                for (const config of invalidConfigs) {
                    if (AudioTypeValidator.isValidSynthConfig(config)) {
                        throw new Error(`Invalid config accepted: ${JSON.stringify(config)}`);
                    }
                }
                
                updateMetric('type-validation-status', 'âœ… æ­£å¸¸');
                logToDisplay('âœ… å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'success');
                return true;
                
            } catch (error) {
                updateMetric('type-validation-status', 'âŒ å¤±æ•—');
                logToDisplay(`âŒ å‹ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testErrorSystem() {
            logToDisplay('ğŸš¨ ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            try {
                // å„ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ãƒ†ã‚¹ãƒˆ
                const audioError = new AudioError('Test error', 'TEST_CODE', { detail: 'test' });
                if (audioError.name !== 'AudioError' || audioError.code !== 'TEST_CODE') {
                    throw new Error('AudioError creation failed');
                }
                
                const contextError = new AudioContextError('Context test');
                if (contextError.name !== 'AudioContextError') {
                    throw new Error('AudioContextError creation failed');
                }
                
                const resourceError = new ResourceError('Resource test');
                if (resourceError.name !== 'ResourceError') {
                    throw new Error('ResourceError creation failed');
                }
                
                const synthError = new SynthError('Synth test');
                if (synthError.name !== 'SynthError') {
                    throw new Error('SynthError creation failed');
                }
                
                // JSONåŒ–ãƒ†ã‚¹ãƒˆ
                const errorJson = audioError.toJSON();
                if (!errorJson.message || !errorJson.timestamp) {
                    throw new Error('Error serialization failed');
                }
                
                updateMetric('error-system-status', 'âœ… æ­£å¸¸');
                logToDisplay('âœ… ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'success');
                return true;
                
            } catch (error) {
                updateMetric('error-system-status', 'âŒ å¤±æ•—');
                logToDisplay(`âŒ ã‚¨ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testConstructor() {
            logToDisplay('ğŸ”§ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            try {
                foundationLayer = new AudioFoundationLayer();
                
                // åˆæœŸçŠ¶æ…‹ç¢ºèª
                if (foundationLayer.isInitialized !== false) {
                    throw new Error('Initial isInitialized should be false');
                }
                
                if (foundationLayer.isDisposed !== false) {
                    throw new Error('Initial isDisposed should be false');
                }
                
                if (!(foundationLayer.synthPool instanceof Map)) {
                    throw new Error('synthPool should be Map instance');
                }
                
                if (!(foundationLayer.performanceTracker instanceof AudioPerformanceTracker)) {
                    throw new Error('performanceTracker should be AudioPerformanceTracker instance');
                }
                
                logToDisplay('âœ… ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'success');
                return true;
                
            } catch (error) {
                logToDisplay(`âŒ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testInitialState() {
            logToDisplay('ğŸ” åˆæœŸçŠ¶æ…‹ç¢ºèªé–‹å§‹...', 'info');
            
            try {
                if (!foundationLayer) {
                    foundationLayer = new AudioFoundationLayer();
                }
                
                const debugInfo = foundationLayer.getDebugInfo();
                
                // ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ç¢ºèª
                if (debugInfo.system.isInitialized !== false) {
                    throw new Error('System should not be initialized initially');
                }
                
                // ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ…‹ç¢ºèª
                if (debugInfo.resources.activeSynths !== 0) {
                    throw new Error('Should have no active synths initially');
                }
                
                // çµ±è¨ˆç¢ºèª
                if (debugInfo.statistics.synthsCreated !== 0) {
                    throw new Error('Initial synth count should be 0');
                }
                
                logToDisplay('âœ… åˆæœŸçŠ¶æ…‹ç¢ºèªæˆåŠŸ', 'success');
                logToDisplay(`ğŸ“Š ãƒ‡ãƒãƒƒã‚°æƒ…å ±: ${JSON.stringify(debugInfo, null, 2)}`, 'info');
                return true;
                
            } catch (error) {
                logToDisplay(`âŒ åˆæœŸçŠ¶æ…‹ç¢ºèªå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testDebugInfo() {
            logToDisplay('ğŸ“Š ãƒ‡ãƒãƒƒã‚°æƒ…å ±å–å¾—ãƒ†ã‚¹ãƒˆ...', 'info');
            
            try {
                if (!foundationLayer) {
                    foundationLayer = new AudioFoundationLayer();
                }
                
                const debugInfo = foundationLayer.getDebugInfo();
                
                // å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèª
                const requiredSections = ['system', 'context', 'resources', 'performance', 'statistics'];
                for (const section of requiredSections) {
                    if (!(section in debugInfo)) {
                        throw new Error(`Debug info missing section: ${section}`);
                    }
                }
                
                foundationLayer.debugPrint(); // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ãƒ†ã‚¹ãƒˆ
                
                logToDisplay('âœ… ãƒ‡ãƒãƒƒã‚°æƒ…å ±å–å¾—æˆåŠŸ', 'success');
                return true;
                
            } catch (error) {
                logToDisplay(`âŒ ãƒ‡ãƒãƒƒã‚°æƒ…å ±å–å¾—å¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function testPendingMethods() {
            logToDisplay('ğŸ”® äºˆå®šãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
            
            try {
                if (!foundationLayer) {
                    foundationLayer = new AudioFoundationLayer();
                }
                
                const pendingMethods = [
                    'initializeContext',
                    'resumeContext', 
                    'suspendContext',
                    'createSynth',
                    'disposeSynth'
                ];
                
                for (const method of pendingMethods) {
                    try {
                        await foundationLayer[method]();
                        throw new Error(`Method ${method} should throw 'implementation pending' error`);
                    } catch (error) {
                        if (!error.message.includes('implementation pending')) {
                            throw new Error(`Method ${method} should throw 'implementation pending' error, got: ${error.message}`);
                        }
                    }
                }
                
                logToDisplay('âœ… äºˆå®šãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆæˆåŠŸ - å…¨ã¦pendingçŠ¶æ…‹ç¢ºèª', 'success');
                return true;
                
            } catch (error) {
                logToDisplay(`âŒ äºˆå®šãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
                return false;
            }
        }
        
        function showImplementationPlan() {
            const plan = `
ğŸ“… AudioFoundationLayer å®Ÿè£…è¨ˆç”»:

Phase 1.1: åŸºæœ¬æ§‹é€ ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾© âœ…
- å‹å®šç¾©ãƒ»ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ä½œæˆå®Œäº†
- AudioFoundationLayerã‚¯ãƒ©ã‚¹éª¨æ ¼å®Œäº†
- åŸºæœ¬ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ å®Œäº†

Phase 1.2: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  (äºˆå®š)
- initializeContext() å®Ÿè£…
- getContextState() å®Ÿè£…  
- resumeContext() / suspendContext() å®Ÿè£…

Phase 1.3: ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  (äºˆå®š)
- createSynth() å®Ÿè£…
- disposeSynth() å®Ÿè£…
- synthPool ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…

Phase 1.4: ç›£è¦–ãƒ»ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  (äºˆå®š)
- getResourceStats() å®Ÿè£…
- ãƒ˜ãƒ«ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹å®Ÿè£…
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–æ©Ÿèƒ½å®Ÿè£…

Phase 1.5: ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (äºˆå®š)
- åŒ…æ‹¬çš„å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆ
- çµ±åˆãƒ†ã‚¹ãƒˆä½œæˆ
- ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆä½œæˆ
            `;
            
            logToDisplay(plan, 'info');
        }
        
        // ==================== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° ====================
        
        function logToDisplay(message, type = 'info') {
            const display = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const typeClass = type || 'info';
            
            const logEntry = `[${timestamp}] ${message}`;
            
            if (display.textContent === 'ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...') {
                display.textContent = '';
            }
            
            display.textContent += logEntry + '\n';
            display.scrollTop = display.scrollHeight;
            
            // ãƒ†ã‚¹ãƒˆçµæœè¨˜éŒ²
            testResults.push({
                timestamp: Date.now(),
                type,
                message
            });
            
            console.log(`[AudioFoundationTest] ${logEntry}`);
        }
        
        function updateMetric(metricId, value) {
            const element = document.getElementById(metricId);
            if (element) {
                element.textContent = value;
            }
        }
        
        function updatePhaseStatus(phase, status) {
            const indicators = document.querySelectorAll('.phase-indicator');
            indicators.forEach(indicator => {
                if (indicator.textContent.includes(`Phase ${phase}`)) {
                    indicator.className = `phase-indicator phase-${status}`;
                }
            });
        }
        
        function clearLog() {
            document.getElementById('test-results').textContent = 'ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...';
            testResults = [];
        }
        
        function exportTestResults() {
            const exportData = {
                session: testSession,
                results: testResults,
                timestamp: new Date().toISOString(),
                phase: '1.1',
                summary: {
                    totalTests: testResults.filter(r => r.message.includes('ãƒ†ã‚¹ãƒˆ')).length,
                    successfulTests: testResults.filter(r => r.type === 'success').length,
                    errors: testResults.filter(r => r.type === 'error').length
                }
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `audio-foundation-test-phase1.1-${Date.now()}.json`;
            link.click();
            
            logToDisplay('ğŸ’¾ ãƒ†ã‚¹ãƒˆçµæœã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
        window.testPhase11 = testPhase11;
        window.testClassStructure = testClassStructure;
        window.testTypeSystem = testTypeSystem;
        window.testErrorSystem = testErrorSystem;
        window.testConstructor = testConstructor;
        window.testInitialState = testInitialState;
        window.testDebugInfo = testDebugInfo;
        window.testPendingMethods = testPendingMethods;
        window.showImplementationPlan = showImplementationPlan;
        window.clearLog = clearLog;
        window.exportTestResults = exportTestResults;
        
        // åˆæœŸåŒ–å®Ÿè¡Œ
        logToDisplay('ğŸ”§ AudioFoundationLayer ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†', 'success');
        logToDisplay('ğŸ§ª Phase 1.1 ãƒ†ã‚¹ãƒˆã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸ', 'info');
        
    </script>
</body>
</html>