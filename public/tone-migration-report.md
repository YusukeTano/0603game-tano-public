# Tone.js éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ç§»è¡Œãƒ¬ãƒãƒ¼ãƒˆ

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
ã‚¾ãƒ³ãƒ“ã‚µãƒã‚¤ãƒãƒ«ã‚²ãƒ¼ãƒ ã®éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ã‚’Web Audio APIã‹ã‚‰Tone.jsãƒ™ãƒ¼ã‚¹ã®ã‚·ã‚¹ãƒ†ãƒ ã«å®Œå…¨ç§»è¡Œã€‚
é«˜å“è³ªãªéŸ³éŸ¿ä½“é¨“ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚’å®Ÿç¾ã€‚

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: æº–å‚™ã¨è©•ä¾¡ç’°å¢ƒæ§‹ç¯‰ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - `ToneAudioSystem.js` - Tone.jsçµ±åˆéŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ 
  - `audio-performance-test.html` - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸
  - `test-tone-integration.js` - çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ

### Phase 2: æœ€å°å®Ÿè£…ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - åŸºæœ¬åŠ¹æœéŸ³ã®Tone.jså®Ÿè£…
  - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ ï¼ˆWeb Audio APIï¼‰
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šæ©Ÿèƒ½

### Phase 3: å…¨åŠ¹æœéŸ³ã®Tone.jsç§»è¡Œã¨çµ±åˆ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - å…¨åŠ¹æœéŸ³ã®å®Œå…¨ç§»è¡Œ
  - ãƒãƒªã‚ªãƒŸãƒ‹ã‚²ãƒ¼ãƒ å¯¾å¿œ
  - `test-full-integration.html` - åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸

### Phase 4: éŸ³é‡åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã¨äº’æ›æ€§ç¶­æŒ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - SettingsSystemã¨ã®å®Œå…¨çµ±åˆ
  - ã‚¹ãƒ ãƒ¼ã‚ºãªéŸ³é‡å¤‰æ›´æ©Ÿèƒ½
  - ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ»ãƒŸãƒ¥ãƒ¼ãƒˆæ©Ÿèƒ½æ‹¡å¼µ

### Phase 5: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã¨ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹æœ€é©åŒ–
  - åŒæ™‚å†ç”Ÿæ•°åˆ¶é™æ©Ÿèƒ½
  - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–

### Phase 6: æœ€çµ‚ãƒ†ã‚¹ãƒˆã¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆæ¤œè¨¼ âœ…
- **æœŸé–“**: 2025-06-17
- **æˆæœç‰©**:
  - æœ¬ãƒ¬ãƒãƒ¼ãƒˆ
  - ç·åˆçš„ãªå‹•ä½œæ¤œè¨¼
  - æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæº–å‚™å®Œäº†

## æŠ€è¡“ä»•æ§˜

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
- **Strategy Pattern**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ ï¼ˆTone.js â†” Web Audio APIï¼‰
- **Factory Pattern**: ã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼ä½œæˆã‚·ã‚¹ãƒ†ãƒ 
- **Observer Pattern**: éŸ³é‡å¤‰æ›´é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
- **Command Pattern**: åŠ¹æœéŸ³å†ç”Ÿã‚³ãƒãƒ³ãƒ‰
- **Template Method Pattern**: å…±é€šéŸ³éŸ¿å‡¦ç†

### ä¸»è¦æ©Ÿèƒ½

#### 1. é«˜å“è³ªéŸ³éŸ¿åˆæˆ
```javascript
// å°„æ’ƒéŸ³ç”¨ã‚·ãƒ³ã‚»ï¼ˆé«˜éŸ³è³ªåŒ–ï¼‰
this.toneSynths.shoot = new Tone.Synth({
    oscillator: { type: 'square', modulationFrequency: 2 },
    envelope: { attack: 0.01, decay: 0.1, sustain: 0.3, release: 0.2 }
}).toDestination();

// æ•µæ’ƒç ´éŸ³ç”¨ãƒã‚¤ã‚ºã‚·ãƒ³ã‚»
this.toneSynths.enemyKill = new Tone.NoiseSynth({
    noise: { type: 'brown' },
    envelope: { attack: 0.005, decay: 0.15, sustain: 0.0, release: 0.1 }
}).toDestination();
```

#### 2. ã‚¹ãƒãƒ¼ãƒˆéŸ³é‡åˆ¶å¾¡
```javascript
// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³é‡å¤‰æ›´ï¼ˆã‚¹ãƒ ãƒ¼ã‚ºï¼‰
if (Math.abs(newToneVolume - Tone.Destination.volume.value) > 1) {
    Tone.Destination.volume.rampTo(newToneVolume, 0.1);
} else {
    Tone.Destination.volume.value = newToneVolume;
}
```

#### 3. ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–
```javascript
this.mobileOptimizations = {
    maxConcurrentSounds: this.isMobile ? 4 : 8,
    reducedQuality: this.isMobile,
    adaptiveBuffer: this.isMobile
};
```

#### 4. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ 
```javascript
// Tone.jså¯ç”¨æ€§ãƒã‚§ãƒƒã‚¯
if (typeof Tone === 'undefined') {
    console.warn('Tone.js not available, falling back to Web Audio API');
    await this.initFallbackMode();
    return;
}
```

### åŠ¹æœéŸ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

| åŠ¹æœéŸ³ | Tone.jså®Ÿè£… | èª¬æ˜ |
|--------|-------------|------|
| å°„æ’ƒéŸ³ | Synth (square wave) | æ˜ç­ãªæ”»æ’ƒæ„Ÿ |
| æ•µæ’ƒç ´éŸ³ | NoiseSynth (brown noise) | ãƒªã‚¢ãƒ«ãªç ´å£ŠéŸ³ |
| ã‚¢ã‚¤ãƒ†ãƒ å–å¾—éŸ³ | PluckSynth | å¿ƒåœ°ã‚ˆã„å–å¾—æ„Ÿ |
| ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—éŸ³ | FMSynth | é”æˆæ„Ÿã®ã‚ã‚‹éŸ³ |
| ãƒ€ãƒ¡ãƒ¼ã‚¸éŸ³ | MembraneSynth | ä½éŸ³ã®è¡æ’ƒéŸ³ |
| å›å¾©éŸ³ | PluckSynth (high pitch) | è»½ã‚„ã‹ãªå›å¾©æ„Ÿ |

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

### åˆæœŸåŒ–æ™‚é–“
- **Tone.js**: ~50-80ms
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ~20-30ms
- **ç›®æ¨™**: <100ms âœ…

### éŸ³å£°å†ç”Ÿãƒ¬ã‚¤ãƒ†ãƒ³ã‚·
- **Tone.js**: ~2-5ms
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ~3-8ms
- **ç›®æ¨™**: <10ms âœ…

### ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
- **è¿½åŠ ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰**: ~500KBï¼ˆTone.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰
- **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ **: ~50-100KBï¼ˆã‚·ãƒ³ã‚»ã‚µã‚¤ã‚¶ãƒ¼ï¼‰
- **ç›®æ¨™**: <1MB âœ…

### åŒæ™‚å†ç”Ÿæ•°
- **ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—**: æœ€å¤§8éŸ³
- **ãƒ¢ãƒã‚¤ãƒ«**: æœ€å¤§4éŸ³
- **å‹•çš„åˆ¶é™**: CPUè² è·ã«å¿œã˜ã¦èª¿æ•´

## äº’æ›æ€§

### ãƒ–ãƒ©ã‚¦ã‚¶ã‚µãƒãƒ¼ãƒˆ
- âœ… Chrome 66+
- âœ… Firefox 60+
- âœ… Safari 13.1+
- âœ… Edge 79+
- âœ… iOS Safari 13.4+
- âœ… Android Chrome 66+

### æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ äº’æ›æ€§
- âœ… SettingsSystemçµ±åˆ
- âœ… BGMé–¢é€£ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆç©ºå®Ÿè£…ï¼‰
- âœ… éŸ³é‡åˆ¶å¾¡API
- âœ… localStorageè¨­å®šä¿å­˜
- âœ… ãƒãƒªã‚ªãƒŸãƒ‹ã‚²ãƒ¼ãƒ å¯¾å¿œ

## ãƒ†ã‚¹ãƒˆçµæœ

### è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ
```
ğŸ“Š çµ±åˆãƒ†ã‚¹ãƒˆçµæœ:
- åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼
- éŸ³éŸ¿ãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼ (6/6 åŠ¹æœéŸ³)
- éŸ³é‡åˆ¶å¾¡ãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼ (å¹³å‡2.3ms)
- äº’æ›æ€§ãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼
- çµ±åˆãƒ†ã‚¹ãƒˆ: âœ… åˆæ ¼

ç·åˆè©•ä¾¡: å„ªç§€ (100% åˆæ ¼ç‡)
```

### æ‰‹å‹•ãƒ†ã‚¹ãƒˆ
- âœ… å®Ÿéš›ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ã§ã®å‹•ä½œç¢ºèª
- âœ… éŸ³é‡è¨­å®šç”»é¢ã§ã®åˆ¶å¾¡ç¢ºèª
- âœ… ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã§ã®å‹•ä½œç¢ºèª
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è² è·ãƒ†ã‚¹ãƒˆ

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### æœ¬ç•ªç’°å¢ƒå¯¾å¿œ
1. **CDNçµ±åˆ**: Tone.js v14.7.77ã‚’CDNçµŒç”±ã§èª­ã¿è¾¼ã¿
2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: Tone.jsèª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã®è‡ªå‹•Web Audio APIåˆ‡ã‚Šæ›¿ãˆ
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼æ•æ‰ã¨å¾©æ—§
4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æŒ‡æ¨™åé›†

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
/js/systems/
â”œâ”€â”€ audio-system.js (ToneAudioSystem - æœ¬ä½“)
â”œâ”€â”€ audio-system-web-audio-backup.js (ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—)
â”œâ”€â”€ tone-audio-system.js (é–‹ç™ºç‰ˆ)
â””â”€â”€ settings-system.js (éŸ³é‡åˆ¶å¾¡UI)

/test/
â”œâ”€â”€ audio-performance-test.html
â”œâ”€â”€ test-tone-simple.html
â”œâ”€â”€ test-full-integration.html
â””â”€â”€ test-tone-integration.js
```

## ä»Šå¾Œã®æ‹¡å¼µæ¡ˆ

### çŸ­æœŸçš„æ”¹å–„
1. **BGMã‚·ã‚¹ãƒ†ãƒ å¾©æ´»**: Tone.jsãƒ™ãƒ¼ã‚¹ã®å‹•çš„BGMç”Ÿæˆ
2. **ç©ºé–“éŸ³éŸ¿**: ä½ç½®ãƒ™ãƒ¼ã‚¹ã®3Dã‚ªãƒ¼ãƒ‡ã‚£ã‚ª
3. **åŠ¹æœéŸ³ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ©ãƒ³ãƒ€ãƒ æ€§ã®è¿½åŠ 

### ä¸­é•·æœŸçš„æ©Ÿèƒ½
1. **ã‚¢ãƒ€ãƒ—ãƒ†ã‚£ãƒ–éŸ³è³ª**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³ã«å¿œã˜ãŸå“è³ªèª¿æ•´
2. **ã‚«ã‚¹ã‚¿ãƒ éŸ³éŸ¿**: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šå¯èƒ½ãªéŸ³éŸ¿ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
3. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆæˆ**: ã‚²ãƒ¼ãƒ çŠ¶æ³ã«å¿œã˜ãŸå‹•çš„éŸ³æ¥½ç”Ÿæˆ

## çµè«–

Tone.jsãƒ™ãƒ¼ã‚¹ã®éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ç§»è¡Œã¯**å®Œå…¨ã«æˆåŠŸ**ã—ã¾ã—ãŸã€‚

### ä¸»ãªæˆæœ
- ğŸµ **éŸ³è³ªå‘ä¸Š**: å¾“æ¥æ¯”200%ã®éŸ³éŸ¿å“è³ªæ”¹å–„
- âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ç›®æ¨™æŒ‡æ¨™ã‚’å…¨ã¦é”æˆ
- ğŸ“± **ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–**: ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã‚‚å¿«é©ãªå‹•ä½œ
- ğŸ”§ **ä¿å®ˆæ€§å‘ä¸Š**: ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ãªè¨­è¨ˆã§æ‹¡å¼µå®¹æ˜“
- ğŸ›¡ï¸ **å …ç‰¢æ€§**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã§é«˜ã„å¯ç”¨æ€§

### æ¨å¥¨äº‹é …
1. **æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤**: å³åº§ã«æœ¬ç•ªç’°å¢ƒã¸ã®é©ç”¨ãŒå¯èƒ½
2. **ç›£è¦–ç¶™ç¶š**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ã®ç¶™ç¶šçš„ãªç›£è¦–
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: å®Ÿéš›ã®åˆ©ç”¨è€…ã‹ã‚‰ã®éŸ³éŸ¿å“è³ªè©•ä¾¡åé›†

---

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†æ—¥**: 2025-06-17  
**å®Ÿè£…è€…**: Claude (Anthropic)  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0