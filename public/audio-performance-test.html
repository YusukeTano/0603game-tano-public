<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ - Tone.js vs Web Audio API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        
        h1 {
            text-align: center;
            color: #00ff88;
            margin-bottom: 30px;
        }
        
        .test-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .system-panel {
            background: #2a2a2a;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
        }
        
        .system-panel.tone-js {
            border-color: #00ff88;
        }
        
        .system-panel.web-audio {
            border-color: #ff8800;
        }
        
        .system-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .tone-js .system-title {
            color: #00ff88;
        }
        
        .web-audio .system-title {
            color: #ff8800;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group h3 {
            margin: 0 0 10px 0;
            color: #ccc;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #555;
            color: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        button:hover {
            background: #666;
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .tone-js button {
            background: #00aa66;
        }
        
        .tone-js button:hover {
            background: #00cc77;
        }
        
        .web-audio button {
            background: #cc6600;
        }
        
        .web-audio button:hover {
            background: #ff7700;
        }
        
        .metrics-panel {
            background: #2a2a2a;
            border: 2px solid #666;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .metrics-title {
            font-size: 20px;
            color: #00ccff;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .metric-item {
            background: #333;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        
        .metric-label {
            font-size: 12px;
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
            margin-top: 5px;
        }
        
        .status-panel {
            background: #2a2a2a;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .status-title {
            font-size: 18px;
            color: #ffaa00;
            margin-bottom: 10px;
        }
        
        .status-content {
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            background: #1a1a1a;
            padding: 10px;
            border-radius: 5px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-info { color: #00ccff; }
        .log-success { color: #00ff88; }
        .log-warning { color: #ffaa00; }
        .log-error { color: #ff4444; }
        
        .comparison-panel {
            background: #2a2a2a;
            border: 2px solid #9966ff;
            border-radius: 10px;
            padding: 20px;
        }
        
        .comparison-title {
            font-size: 20px;
            color: #bb99ff;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #444;
        }
        
        .comparison-table th {
            background: #333;
            color: #ccc;
            font-weight: bold;
        }
        
        .better {
            color: #00ff88;
            font-weight: bold;
        }
        
        .worse {
            color: #ff4444;
        }
        
        .neutral {
            color: #ffaa00;
        }
        
        @media (max-width: 768px) {
            .test-container {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
    
    <!-- Tone.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.js"></script>
</head>
<body>
    <h1>ğŸµ éŸ³éŸ¿ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h1>
    
    <!-- ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ãƒœã‚¿ãƒ³ -->
    <div style="text-align: center; margin-bottom: 30px;">
        <button onclick="initializeSystems()" style="background: #0066cc; font-size: 16px; padding: 15px 30px;">
            ä¸¡ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆæœŸåŒ–
        </button>
        <button onclick="runPerformanceTest()" style="background: #cc0066; font-size: 16px; padding: 15px 30px; margin-left: 15px;">
            ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        </button>
    </div>
    
    <!-- ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º -->
    <div class="metrics-panel">
        <div class="metrics-title">ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹</div>
        <div class="metrics-grid" id="metrics-grid">
            <!-- å‹•çš„ã«ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- ãƒ†ã‚¹ãƒˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
    <div class="test-container">
        <!-- Tone.js ãƒ‘ãƒãƒ« -->
        <div class="system-panel tone-js">
            <div class="system-title">ğŸ¹ Tone.js ã‚·ã‚¹ãƒ†ãƒ </div>
            
            <div class="control-group">
                <h3>åŸºæœ¬åŠ¹æœéŸ³</h3>
                <div class="button-grid">
                    <button onclick="playToneSound('shoot')">å°„æ’ƒéŸ³</button>
                    <button onclick="playToneSound('enemyKill')">æ•µæ’ƒç ´</button>
                    <button onclick="playToneSound('pickup')">ã‚¢ã‚¤ãƒ†ãƒ å–å¾—</button>
                    <button onclick="playToneSound('levelUp')">ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—</button>
                    <button onclick="playToneSound('damage')">ãƒ€ãƒ¡ãƒ¼ã‚¸</button>
                    <button onclick="playToneSound('pickupHealth')">å›å¾©</button>
                </div>
            </div>
            
            <div class="control-group">
                <h3>é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆ</h3>
                <div class="button-grid">
                    <button onclick="rapidFireTest('tone', 10)">10å›é€£ç¶š</button>
                    <button onclick="rapidFireTest('tone', 50)">50å›é€£ç¶š</button>
                    <button onclick="stopRapidFire('tone')">åœæ­¢</button>
                    <button onclick="memoryTest('tone')">ãƒ¡ãƒ¢ãƒªãƒ†ã‚¹ãƒˆ</button>
                </div>
            </div>
        </div>
        
        <!-- Web Audio API ãƒ‘ãƒãƒ« -->
        <div class="system-panel web-audio">
            <div class="system-title">ğŸ›ï¸ Web Audio API</div>
            
            <div class="control-group">
                <h3>åŸºæœ¬åŠ¹æœéŸ³</h3>
                <div class="button-grid">
                    <button onclick="playWebAudioSound('shoot')">å°„æ’ƒéŸ³</button>
                    <button onclick="playWebAudioSound('enemyKill')">æ•µæ’ƒç ´</button>
                    <button onclick="playWebAudioSound('pickup')">ã‚¢ã‚¤ãƒ†ãƒ å–å¾—</button>
                    <button onclick="playWebAudioSound('levelUp')">ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—</button>
                    <button onclick="playWebAudioSound('damage')">ãƒ€ãƒ¡ãƒ¼ã‚¸</button>
                    <button onclick="playWebAudioSound('pickupHealth')">å›å¾©</button>
                </div>
            </div>
            
            <div class="control-group">
                <h3>é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆ</h3>
                <div class="button-grid">
                    <button onclick="rapidFireTest('web', 10)">10å›é€£ç¶š</button>
                    <button onclick="rapidFireTest('web', 50)">50å›é€£ç¶š</button>
                    <button onclick="stopRapidFire('web')">åœæ­¢</button>
                    <button onclick="memoryTest('web')">ãƒ¡ãƒ¢ãƒªãƒ†ã‚¹ãƒˆ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³è¡¨ç¤º -->
    <div class="status-panel">
        <div class="status-title">ğŸ“‹ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³</div>
        <div class="status-content" id="status-log">
            <div class="log-entry log-info">ãƒ†ã‚¹ãƒˆé–‹å§‹æº–å‚™ä¸­...</div>
        </div>
    </div>
    
    <!-- æ¯”è¼ƒçµæœ -->
    <div class="comparison-panel">
        <div class="comparison-title">âš¡ ã‚·ã‚¹ãƒ†ãƒ æ¯”è¼ƒçµæœ</div>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>é …ç›®</th>
                    <th>Tone.js</th>
                    <th>Web Audio API</th>
                    <th>çµæœ</th>
                </tr>
            </thead>
            <tbody id="comparison-tbody">
                <tr>
                    <td>åˆæœŸåŒ–æ™‚é–“</td>
                    <td id="tone-init-time">-</td>
                    <td id="web-init-time">-</td>
                    <td id="init-result">-</td>
                </tr>
                <tr>
                    <td>éŸ³å£°å†ç”Ÿãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</td>
                    <td id="tone-latency">-</td>
                    <td id="web-latency">-</td>
                    <td id="latency-result">-</td>
                </tr>
                <tr>
                    <td>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</td>
                    <td id="tone-memory">-</td>
                    <td id="web-memory">-</td>
                    <td id="memory-result">-</td>
                </tr>
                <tr>
                    <td>éŸ³è³ªè©•ä¾¡</td>
                    <td id="tone-quality">é«˜å“è³ª</td>
                    <td id="web-quality">æ¨™æº–</td>
                    <td id="quality-result" class="better">Tone.js å„ªä½</td>
                </tr>
                <tr>
                    <td>APIä½¿ã„ã‚„ã™ã•</td>
                    <td id="tone-api">é«˜</td>
                    <td id="web-api">ä¸­</td>
                    <td id="api-result" class="better">Tone.js å„ªä½</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script type="module">
        // ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆES6ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å½¢å¼ï¼‰
        import { ToneAudioSystem } from './js/systems/tone-audio-system.js';
        import { AudioSystem } from './js/systems/audio-system.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let toneSystem = null;
        let webAudioSystem = null;
        let metrics = {
            tone: {
                initTime: 0,
                avgPlayTime: 0,
                playCount: 0,
                memoryUsage: 0
            },
            web: {
                initTime: 0,
                avgPlayTime: 0,
                playCount: 0,
                memoryUsage: 0
            }
        };
        let rapidFireIntervals = { tone: null, web: null };
        
        // ãƒ­ã‚°å‡ºåŠ›
        function log(message, type = 'info') {
            const statusLog = document.getElementById('status-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            statusLog.appendChild(logEntry);
            statusLog.scrollTop = statusLog.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
        function updateMetrics() {
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="metric-item">
                    <div class="metric-label">Tone.js åˆæœŸåŒ–æ™‚é–“</div>
                    <div class="metric-value">${metrics.tone.initTime.toFixed(2)}ms</div>
                </div>
                <div class="metric-item">
                    <div class="metric-label">Web Audio åˆæœŸåŒ–æ™‚é–“</div>
                    <div class="metric-value">${metrics.web.initTime.toFixed(2)}ms</div>
                </div>
                <div class="metric-item">
                    <div class="metric-label">Tone.js å¹³å‡å†ç”Ÿæ™‚é–“</div>
                    <div class="metric-value">${metrics.tone.avgPlayTime.toFixed(2)}ms</div>
                </div>
                <div class="metric-item">
                    <div class="metric-label">Web Audio å¹³å‡å†ç”Ÿæ™‚é–“</div>
                    <div class="metric-value">${metrics.web.avgPlayTime.toFixed(2)}ms</div>
                </div>
                <div class="metric-item">
                    <div class="metric-label">Tone.js å†ç”Ÿå›æ•°</div>
                    <div class="metric-value">${metrics.tone.playCount}</div>
                </div>
                <div class="metric-item">
                    <div class="metric-label">Web Audio å†ç”Ÿå›æ•°</div>
                    <div class="metric-value">${metrics.web.playCount}</div>
                </div>
            `;
        }
        
        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        async function initializeSystems() {
            log('ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚’é–‹å§‹...', 'info');
            
            try {
                // Tone.js ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
                log('Tone.js ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...', 'info');
                const toneStartTime = performance.now();
                
                toneSystem = new ToneAudioSystem({ audioSystem: null });
                await toneSystem.initAudio();
                
                metrics.tone.initTime = performance.now() - toneStartTime;
                log(`Tone.js ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº† (${metrics.tone.initTime.toFixed(2)}ms)`, 'success');
                
                // Web Audio API ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
                log('Web Audio API ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...', 'info');
                const webStartTime = performance.now();
                
                webAudioSystem = new AudioSystem({ audioSystem: null });
                await webAudioSystem.initAudio();
                
                metrics.web.initTime = performance.now() - webStartTime;
                log(`Web Audio API ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº† (${metrics.web.initTime.toFixed(2)}ms)`, 'success');
                
                // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
                updateMetrics();
                updateComparison();
                
                log('ä¸¡ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                
            } catch (error) {
                log(`åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error('Initialization error:', error);
            }
        }
        
        // Tone.js éŸ³å£°å†ç”Ÿ
        function playToneSound(soundType) {
            if (!toneSystem) {
                log('Tone.js ã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning');
                return;
            }
            
            const startTime = performance.now();
            
            try {
                if (toneSystem.sounds[soundType]) {
                    toneSystem.sounds[soundType]();
                    
                    const playTime = performance.now() - startTime;
                    metrics.tone.playCount++;
                    metrics.tone.avgPlayTime = 
                        (metrics.tone.avgPlayTime * (metrics.tone.playCount - 1) + playTime) / metrics.tone.playCount;
                    
                    updateMetrics();
                    log(`Tone.js ${soundType} å†ç”Ÿ (${playTime.toFixed(2)}ms)`, 'info');
                } else {
                    log(`Tone.js: ${soundType} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`, 'warning');
                }
            } catch (error) {
                log(`Tone.js å†ç”Ÿã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        // Web Audio API éŸ³å£°å†ç”Ÿ
        function playWebAudioSound(soundType) {
            if (!webAudioSystem) {
                log('Web Audio API ã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning');
                return;
            }
            
            const startTime = performance.now();
            
            try {
                if (webAudioSystem.sounds[soundType]) {
                    webAudioSystem.sounds[soundType]();
                    
                    const playTime = performance.now() - startTime;
                    metrics.web.playCount++;
                    metrics.web.avgPlayTime = 
                        (metrics.web.avgPlayTime * (metrics.web.playCount - 1) + playTime) / metrics.web.playCount;
                    
                    updateMetrics();
                    log(`Web Audio ${soundType} å†ç”Ÿ (${playTime.toFixed(2)}ms)`, 'info');
                } else {
                    log(`Web Audio: ${soundType} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`, 'warning');
                }
            } catch (error) {
                log(`Web Audio å†ç”Ÿã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        // é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆ
        function rapidFireTest(systemType, count) {
            log(`${systemType} ã‚·ã‚¹ãƒ†ãƒ ã§${count}å›é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆé–‹å§‹`, 'info');
            
            let currentCount = 0;
            const interval = setInterval(() => {
                if (currentCount >= count) {
                    clearInterval(interval);
                    log(`${systemType} é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆå®Œäº†`, 'success');
                    return;
                }
                
                if (systemType === 'tone') {
                    playToneSound('shoot');
                } else {
                    playWebAudioSound('shoot');
                }
                
                currentCount++;
            }, 100); // 100msé–“éš”
            
            rapidFireIntervals[systemType] = interval;
        }
        
        // é€£ç¶šå†ç”Ÿåœæ­¢
        function stopRapidFire(systemType) {
            if (rapidFireIntervals[systemType]) {
                clearInterval(rapidFireIntervals[systemType]);
                rapidFireIntervals[systemType] = null;
                log(`${systemType} é€£ç¶šå†ç”Ÿã‚’åœæ­¢`, 'info');
            }
        }
        
        // ãƒ¡ãƒ¢ãƒªãƒ†ã‚¹ãƒˆ
        function memoryTest(systemType) {
            log(`${systemType} ãƒ¡ãƒ¢ãƒªãƒ†ã‚¹ãƒˆé–‹å§‹`, 'info');
            
            // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æ¸¬å®šï¼ˆæ¦‚ç®—ï¼‰
            if (performance.memory) {
                const beforeMemory = performance.memory.usedJSHeapSize;
                
                // 100å›é€£ç¶šå†ç”Ÿ
                for (let i = 0; i < 100; i++) {
                    if (systemType === 'tone') {
                        playToneSound('shoot');
                    } else {
                        playWebAudioSound('shoot');
                    }
                }
                
                setTimeout(() => {
                    const afterMemory = performance.memory.usedJSHeapSize;
                    const memoryDiff = afterMemory - beforeMemory;
                    metrics[systemType === 'tone' ? 'tone' : 'web'].memoryUsage = memoryDiff;
                    
                    log(`${systemType} ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ${(memoryDiff / 1024).toFixed(2)} KB`, 'info');
                    updateMetrics();
                }, 1000);
            } else {
                log('ãƒ¡ãƒ¢ãƒªæ¸¬å®šã¯ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning');
            }
        }
        
        // æ¯”è¼ƒçµæœæ›´æ–°
        function updateComparison() {
            // åˆæœŸåŒ–æ™‚é–“æ¯”è¼ƒ
            const initDiff = metrics.tone.initTime - metrics.web.initTime;
            document.getElementById('tone-init-time').textContent = `${metrics.tone.initTime.toFixed(2)}ms`;
            document.getElementById('web-init-time').textContent = `${metrics.web.initTime.toFixed(2)}ms`;
            
            const initResult = document.getElementById('init-result');
            if (Math.abs(initDiff) < 5) {
                initResult.textContent = 'åŒç­‰';
                initResult.className = 'neutral';
            } else if (initDiff < 0) {
                initResult.textContent = 'Tone.js é«˜é€Ÿ';
                initResult.className = 'better';
            } else {
                initResult.textContent = 'Web Audio é«˜é€Ÿ';
                initResult.className = 'worse';
            }
            
            // ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ¯”è¼ƒ
            const latencyDiff = metrics.tone.avgPlayTime - metrics.web.avgPlayTime;
            document.getElementById('tone-latency').textContent = `${metrics.tone.avgPlayTime.toFixed(2)}ms`;
            document.getElementById('web-latency').textContent = `${metrics.web.avgPlayTime.toFixed(2)}ms`;
            
            const latencyResult = document.getElementById('latency-result');
            if (Math.abs(latencyDiff) < 1) {
                latencyResult.textContent = 'åŒç­‰';
                latencyResult.className = 'neutral';
            } else if (latencyDiff < 0) {
                latencyResult.textContent = 'Tone.js ä½é…å»¶';
                latencyResult.className = 'better';
            } else {
                latencyResult.textContent = 'Web Audio ä½é…å»¶';
                latencyResult.className = 'worse';
            }
        }
        
        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        async function runPerformanceTest() {
            log('è‡ªå‹•ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹', 'info');
            
            if (!toneSystem || !webAudioSystem) {
                log('ã‚·ã‚¹ãƒ†ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å…ˆã«åˆæœŸåŒ–ã—ã¦ãã ã•ã„ã€‚', 'warning');
                return;
            }
            
            // å„ç¨®éŸ³å£°ã‚’é †ç•ªã«ãƒ†ã‚¹ãƒˆ
            const soundTypes = ['shoot', 'enemyKill', 'pickup', 'levelUp', 'damage', 'pickupHealth'];
            
            for (const soundType of soundTypes) {
                log(`${soundType} éŸ³å£°ãƒ†ã‚¹ãƒˆä¸­...`, 'info');
                
                // Tone.js ãƒ†ã‚¹ãƒˆ
                playToneSound(soundType);
                await new Promise(resolve => setTimeout(resolve, 200));
                
                // Web Audio ãƒ†ã‚¹ãƒˆ
                playWebAudioSound(soundType);
                await new Promise(resolve => setTimeout(resolve, 200));
            }
            
            // é€£ç¶šå†ç”Ÿãƒ†ã‚¹ãƒˆ
            log('é€£ç¶šå†ç”Ÿãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...', 'info');
            rapidFireTest('tone', 20);
            await new Promise(resolve => setTimeout(resolve, 3000));
            rapidFireTest('web', 20);
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            log('ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†', 'success');
            updateComparison();
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã¨ã—ã¦å…¬é–‹
        window.initializeSystems = initializeSystems;
        window.playToneSound = playToneSound;
        window.playWebAudioSound = playWebAudioSound;
        window.rapidFireTest = rapidFireTest;
        window.stopRapidFire = stopRapidFire;
        window.memoryTest = memoryTest;
        window.runPerformanceTest = runPerformanceTest;
        
        // åˆæœŸãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º
        updateMetrics();
        
        log('ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒæº–å‚™å®Œäº†', 'success');
    </script>
</body>
</html>